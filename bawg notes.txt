Make separate pages (and links) for flower lists (by color and "all")
with names only (for bandwidth saving) and photos only (for showing off).

Print errors:
  *no color listed
  *listed color not supported
  *broken photo
  no scientific name for leaf page
  multiple scientific names from observations.csv

###############################################################################

how to mass rename files:
for f in *.jpg; do git mv "$f" "$(echo $f | sed 's/-\([-0-9]*\)\.jpg$/,\1.jpg/')"; done

###############################################################################

Create a script to help copy new and changed files to a portable device.
  Copy new and modified files to a new (and git-ignored) folder,
    ready for the user to copy them over using Windows Explorer.
  Record the timestamp of all files to a (git-ignored) database
    to be used next time for identifying new and modified files.
  Deleted files won't be deleted, but they won't cause any harm.
  Include top-level files that should be copied if they are modified,
    e.g. index.html, bafg.css, search.js, pages.js
  Perhaps allow an argument with a date so that all files modified
    after that date are copied in case the database gets screwed up.
  (Explorer displays the photo creation date, but the file modification
    data is still correct internally.)

Should autogenerated families be structured more like top-level lists
(with a complete indented hierarchy)?

Put month info in table format with bar chart.
Put month info side by side with park info (depending on display width?)

/cygdrive/c/Python37/python -m cProfile -s cumtime src/bawg.py | less

Add (optional) color info for unobserved flowers?
How would that be presented?  (border on CalPhoto placeholder?)

Make links up to the key (or any other parent) use an anchor position
that highlights the child's section of the key, similar to the
glossary.  (May require similar positioning tricks.)

Have a way to link from txt to the key to a flower (e.g. for
rough-fruited buttercup in buttercups).
E.g. {-buttercups#rough-fruited buttercup}

If all modified pages are under a single modified parent (excluding
"all" and color lists), bring up that parent page automatically.  (Or
simply list it first, or list the modified pages hierarchically.
Might be able to reuse the html generation for color lists.)

Support color:none for non-flowering plants.  Allow it to be used at
an upper level of hierarchy, from where it automatically propagates
downward through the tree.  (Should I also allow propagation for other
colors?  It could come in handy, e.g. for a genus that is always the
same color.  But it would also make it easy to be sloppy and not
verify the correct color of everything.)

For HTML files, use the scientific name instead of the common name if
possible?  This reduces churn when common names change, but it makes
it harder to find the corresponding txt file.  In any case, common
names don't change often, and scientific names can change, too.

For a line that begins with '[', include an automatic h3 or lower
format on the remainder of the text line.  Use increasing header
numbers based on the bracket depth.  Line breaks remain <br/>.
Recognize this and continue the header, or require that the line be
run together with <br/> in the middle?

Parts of a pea flower:
https://en.wikipedia.org/wiki/Papilionaceous_flower#/media/File:Sesbanea_bispinosa,_crop.jpg

The banner is a single petal, but a crease along its midline may give
the appearance of two petals fused at the edge.


sea muilla:
perianth parts (no obvious corolla/calyx separation)
sepals (in bud, but opening) (no calyx tube)
filaments, anthers, pollen
ovary, style, stigma
pedicels
bracts
peduncle

milk maids:
petals
sepals

buttercup:
petals
sepals
pedicels
bracts
peduncle
anthers
pistil hard to see

sun cup:
petals
sepals
pedicel
anthers, filaments
stigma, style hidden
bracts out of view

field bindweed (2 photos)
petals
calyx (sepals indistinct)
pedicel
ovary/style/stigma
filaments/anthers

yellow mariposa lily: (2 photos; bawg photos are good)
petals
sepals
anthers, filaments
stigma, ovary
pedicel
no bracts

pale flax
good side view down to bracts
top view shows all the parts, but is too crowded to label


Add glossary entries to replace as many Jepson terms as I can.  If I
can get all of them, then perhaps I can make use of a Jepson term an
error.


Apply standard page substitutions on glossary pages, e.g. blank lines
to <p/>.

Add inflorescence shape definitions for sedges.  (Possibly share the
glossary with grasses, but probably not.)


Redo shrink() to instead allow testing two names against each other
while testing specific plural substitutions.  (But also keep the code
to throw out non-word characters from each.)  E.g.
is_same(name, 'z', 'zzes')

Detect when a glossary term is defined twice in the same file (or
definition) (e.g. a typo).

Allow iNaturalist taxon ID to be specified since iNaturalist fails for
shared genus names, e.g. onions (Allium).

Separate surprise_obs into multiple parts:
  species that don't have a page despite there being a genus page
    (or should it be all plant species that don't have a page?)
    (includes subspecies if the species page is missing.)
  subspecies that have a common name and a genus page (or are plants),
    but no page.
  subspecies that don't have a common name but are under a species
    for which subspecies are listed.


It'd be nice to link to a section of glossary words with the selected
one highlighted.  E.g. clicking "pedicel" would link to "Parts of a
flower" (highlighted in pale gray) with the "pedicel" entry
highlighted in yellow partway down the page.  This would require
Javascript for the yellow highlighting using extra information in the
URL, e.g. flower%20glossary.html?term=pedicel#parts+of+a+flower.  A
mobile screen is often too small for the section (especially if it
includes figures, but even without them).  Is some other solution
possible to indicate that the linked term is part of a section?

Now that glossary terms are flagged when used out of place, try moving
many of the plant glossary entries to the flower glossary.  Perhaps a
command-line arg could flag glossary terms that are never used in the
'plant glossary' context.


Use img property alt="" to indicate to blind users that a description
of the photo is not helpful?

I've removed the search penalty for autopropagated and unobserved pages.
I should also order them lower in pages.js.


Make the hierarchy more generic to fit anyone's taxonomic priorities:

Create a page for flowering plants (replacing 'all.html') with a
marker that causes it to have its whole hierarchy listed.  Create
pages for each flowering plant color with markers to borrow a subset
of children of flowering plants.  The flowering plant txt includes
manual links to the color pages (which are somehow outside the normal
hierarchy?)

Mark the flowering plants page as the parent of all pages without
parents (that aren't marked as top-level pages).  Obviously, only one
page can be marked this way.

Mark the flowering plants page so that all descendents are
automatically assigned to a family from observations.csv (with an
error printed if a family is not known).

Mark top-level pages in the pages' txt, not in the script code.

Mark the flowering plants page so that all descendents list themselves
as "part of" a family and "part of flowering plants".

Mark the flowering plants page as requiring a common name for all
families.

Keep a taxon page and its inline glossary as separate entries in
pages.js (as it is now) so that each gets the right priority.  But
suppress a glossary match (either on the glossary "page" or a glossary
term) if the taxon page already matches.

How should a taxon's inline glossary be named in pages.js?  Perhaps
all glossaries should be called "glossary: [taxon]".  (Jepson would be
"glossary: Jepson eFlora".)

Create a function to easily compare ranks beyond just genus/species.
Flag an error for unknown ranks when the sci name is "[rank] [Name]".

Format glossary ToC better so that it is clearly a part of the
"Glossary table of contents", especially when "plant glossary" is the
current glossary and thus bold and not linked.

Instead of using index numbers as temporary child IDs, use the
scientific name (if available) or the common name.  These are
guaranteed to find the correct page later unless there is an error
elsewhere.
